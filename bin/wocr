#!/usr/bin/env node

var fs = require('fs'),
    program = require('commander'),
    pjson = require('../package.json'),
    path =  require('path'),
    clss = require(path.join('..','lib','main'));

program
    .version(pjson.version)
    .description('wocr')
    .usage('[options]')
    .option('-c [c]','run the ocr with a different camera index')
    .option('-w [w]','the width of the cap image')
    .option('-h [h]','the height of the cap image')
    .option('-f [f]','the image file name')

    .option('-g, --pattern [pattern]','the glob pattern (default: *.jpg)')
    .option('-p, --path [path]','the path for watching/ searching')
    .option('-s, --scale [scale]','the height-scaling, depening on speed and exposure')
    .parse(process.argv);


if (program.C){
  var ocr = new clss.OCR(program.C*1,program.W,program.H);
  ocr.start(true);
}else if(program.F){
  var ocr = new clss.OCR(program.C*1,program.W,program.H);
  ocr.singleFile(program.F,false);
}else if(program.path){

  var s = program.scale || 2;
  var ocr = new clss.OCR(program.C*1,program.W,program.H,s);
  var pattern = program.pattern || '*.gige';
  ocr.glob(pattern,program.path);

}
